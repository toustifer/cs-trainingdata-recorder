# CS2 è®­ç»ƒæ•°æ®æ”¶é›†ç³»ç»Ÿ - ç¯å¢ƒé…ç½®æ•™ç¨‹

## ç³»ç»Ÿè¦æ±‚

### ç¡¬ä»¶è¦æ±‚

### è½¯ä»¶è¦æ±‚

- æ“ä½œç³»ç»Ÿï¼šWindows 10/11ï¼ˆ64ä½ï¼‰
- Node.jsï¼šv18 æˆ–æ›´é«˜ç‰ˆæœ¬
- PostgreSQLï¼š14 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Steam å®¢æˆ·ç«¯ï¼šå¿…é¡»ä¿æŒè¿è¡ŒçŠ¶æ€**
- CS2 æ¸¸æˆï¼šå·²å®‰è£…å¹¶å¯æ­£å¸¸è¿è¡Œ
- Git Bash æˆ– PowerShellï¼šç”¨äºæ‰§è¡Œå‘½ä»¤

---

## ç¯å¢ƒæ£€æŸ¥ç»“æœ

### âœ… æ‰€æœ‰å¿…éœ€ç»„ä»¶å·²å°±ç»ª

ç»è¿‡å…¨é¢æ£€æŸ¥ï¼Œä½ çš„ç³»ç»Ÿæ‰€æœ‰å¿…è¦ç»„ä»¶éƒ½å·²æ­£ç¡®é…ç½®ï¼š

| ç»„ä»¶                | çŠ¶æ€        | è¯¦æƒ…                             |
| ------------------- | ----------- | -------------------------------- |
| PostgreSQL æ•°æ®åº“   | âœ… å·²é…ç½®   | PostgreSQL 18.1ï¼Œç«¯å£ 5432       |
| Node.js ç¯å¢ƒ        | âœ… å·²é…ç½®   | v22.21.1                         |
| Steam å®¢æˆ·ç«¯        | âš ï¸ éœ€è¿è¡Œ | ä½¿ç”¨å‰è¯·ç¡®ä¿ Steam å·²å¯åŠ¨å¹¶ç™»å½•  |
| CS2 æ¸¸æˆ            | âœ… å·²å®‰è£…   | D:/Program Files (x86)/Steam/... |
| CLI å·¥å…·            | âœ… å·²æ„å»º   | out/cli.js å­˜åœ¨                  |
| CS2 æœåŠ¡å™¨æ’ä»¶      | âœ… å·²å®‰è£…   | server.dll å·²éƒ¨ç½²                |
| gameinfo.gi é…ç½®    | âœ… å·²é…ç½®   | åŒ…å« csgo/csdm é…ç½®              |
| æ•°æ®åº“è¡¨ç»“æ„        | âœ… å·²è¿ç§»   | schema_version = 10              |
| training_windows è¡¨ | âœ… å·²åˆ›å»º   | åŒ…å«æ‰€æœ‰å¿…è¦å­—æ®µ                 |

---

## å®Œæ•´å®‰è£…æ­¥éª¤ï¼ˆå…¨æ–°ç¯å¢ƒï¼‰

å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡é…ç½®ç¯å¢ƒï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

### æ­¥éª¤ 1ï¼šå®‰è£… Node.js ä¾èµ–

```bash
cd D:\myprogram\cs_learning\tools\cs-demo-manager
npm install
```

ç­‰å¾…æ‰€æœ‰ä¾èµ–å®‰è£…å®Œæˆï¼ˆå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼‰ã€‚

### æ­¥éª¤ 2ï¼šæ„å»º CLI å·¥å…·

```bash
node scripts/build-cli-only.mjs
```

è¿™ä¼šç”Ÿæˆ `out/cli.js` æ–‡ä»¶ã€‚

### æ­¥éª¤ 3ï¼šåˆå§‹åŒ–æ•°æ®åº“ï¼ˆå¿…é¡»ï¼ï¼‰

**åˆ›å»ºæ•°æ®åº“ï¼š**

```bash
# Windows PowerShell æˆ– Git Bash
export PGPASSWORD='88683139'
psql -h 127.0.0.1 -U postgres -c "CREATE DATABASE csdm;"
```

**è¿è¡Œæ•°æ®åº“è¿ç§»ï¼ˆåˆ›å»ºè¡¨ç»“æ„ï¼‰ï¼š**

```bash
cd D:\myprogram\cs_learning\tools\cs-demo-manager
node out/cli.js migrate
```

**éªŒè¯æ•°æ®åº“ï¼š**

```bash
export PGPASSWORD='88683139'
psql -h 127.0.0.1 -U postgres -d csdm -c "\dt"
```

åº”è¯¥çœ‹åˆ° `training_windows`ã€`demos`ã€`matches` ç­‰è¡¨ã€‚

**æ£€æŸ¥ schema ç‰ˆæœ¬ï¼š**

```bash
psql -h 127.0.0.1 -U postgres -d csdm -c "SELECT schema_version FROM schema_migrations;"
```

åº”è¯¥æ˜¾ç¤º `schema_version = 10`ã€‚

### æ­¥éª¤ 4ï¼šè‡ªåŠ¨å®‰è£… CS2 æœåŠ¡å™¨æ’ä»¶

```bash
node scripts/install-plugin.mjs
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š

1. æŸ¥æ‰¾ CS2 æ¸¸æˆå®‰è£…ç›®å½•
2. å¤åˆ¶ `server.dll` åˆ° **CS2æ¸¸æˆç›®å½•**/`game/csgo/csdm/bin/`
3. ä¿®æ”¹ **CS2æ¸¸æˆç›®å½•**/`game/csgo/gameinfo.gi` æ·»åŠ  `Game csgo/csdm` é…ç½®

**æ³¨æ„ï¼š** æ‰€æœ‰æ“ä½œéƒ½åœ¨ CS2 æ¸¸æˆç›®å½•ä¸­è¿›è¡Œï¼Œä¸æ˜¯åœ¨ CS Demo Manager å®‰è£…ç›®å½•ï¼

å¦‚æœè‡ªåŠ¨å®‰è£…å¤±è´¥ï¼Œè¯·å‚è€ƒ"æ‰‹åŠ¨å®‰è£…æ’ä»¶"ç« èŠ‚ã€‚

### æ­¥éª¤ 4ï¼šéªŒè¯å®‰è£…

```bash
# æ£€æŸ¥ CLI å·¥å…·
node out/cli.js --help

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
export PGPASSWORD='88683139'
psql -h 127.0.0.1 -U postgres -d csdm -c "SELECT version();"

# æ£€æŸ¥æ’ä»¶æ–‡ä»¶
ls "D:/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/csdm/bin/server.dll"
```

---

## å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡ Demo æ–‡ä»¶

**è·å– Demo æ–‡ä»¶çš„æ–¹å¼ï¼š**

1. **ä»æ¸¸æˆå†…ä¸‹è½½ï¼š**

   - åœ¨ CS2 ä¸­æ‰“å¼€"è§‚çœ‹"èœå•
   - é€‰æ‹©"ä½ çš„æ¯”èµ›"æˆ–"ä¸‹è½½çš„å›æ”¾"
   - å³é”®ç‚¹å‡»æ¯”èµ› â†’ "ä¸‹è½½å›æ”¾"
   - Demo æ–‡ä»¶ä¿å­˜åœ¨ï¼š`C:\Program Files (x86)\Steam\userdata\<ä½ çš„ID>\730\remote\replays\`
2. **ä»ç«æŠ€å¹³å°è·å–ï¼š**

   - FACEITã€ESEA ç­‰å¹³å°é€šå¸¸æä¾› demo ä¸‹è½½é“¾æ¥
   - ä¸‹è½½åä¿å­˜åˆ°ä½ çš„å·¥ä½œç›®å½•
3. **ä½¿ç”¨ç¤ºä¾‹ Demoï¼š**

   - å°† demo æ–‡ä»¶æ”¾åˆ°ï¼š`D:/myprogram/cs_learning/dataset/1/match.dem`

ç¡®ä¿ä½ æœ‰ä¸€ä¸ª CS2 çš„ demo æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š

```
D:/myprogram/cs_learning/dataset/1/match.dem
```

### ç¬¬äºŒæ­¥ï¼šè·å–ç©å®¶ Steam ID

**è·å– Steam ID çš„æ–¹å¼ï¼š**

1. **ä» Demo æ–‡ä»¶ä¸­æŸ¥è¯¢ï¼š**

   ```bash
   node out/cli.js training-data "demoè·¯å¾„.dem" --list-players
   ```

   è¿™ä¼šåˆ—å‡º demo ä¸­æ‰€æœ‰ç©å®¶çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ Steam IDã€‚
2. **ä» Steam ä¸ªäººèµ„æ–™è·å–ï¼š**

   - æ‰“å¼€ä½ çš„ Steam ä¸ªäººèµ„æ–™é¡µé¢
   - åœ¨åœ°å€æ çœ‹åˆ°ç±»ä¼¼ï¼š`steamcommunity.com/profiles/76561199138765870/`
   - å…¶ä¸­ `76561199138765870` å°±æ˜¯ä½ çš„ Steam ID
3. **ä½¿ç”¨åœ¨çº¿å·¥å…·ï¼š**

   - è®¿é—® https://steamid.io/
   - è¾“å…¥ Steam ç”¨æˆ·åæˆ–ä¸ªäººèµ„æ–™é“¾æ¥è·å– Steam ID

ä½ éœ€è¦çŸ¥é“è¦åˆ†æçš„ç©å®¶çš„ Steam IDï¼ˆ64ä½ï¼‰ã€‚ä¾‹å¦‚ï¼š

```
76561199138765870
```

### ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œå®Œæ•´æµæ°´çº¿

**é‡è¦æç¤ºï¼š**

- âš ï¸ **ç¡®ä¿ Steam å®¢æˆ·ç«¯å·²å¯åŠ¨å¹¶ç™»å½•**
- âš ï¸ **å½•åˆ¶æœŸé—´ä¸è¦æ“ä½œ CS2 çª—å£**
- âš ï¸ **ä¸è¦æœ€å°åŒ– CS2 çª—å£**

åœ¨ Git Bash æˆ– PowerShell ä¸­æ‰§è¡Œï¼š

```bash
cd D:\myprogram\cs_learning\tools\cs-demo-manager

node scripts/complete-training-pipeline.mjs \
  "D:/myprogram/cs_learning/dataset/1/match.dem" \
  76561199138765870 \
  1
```

**å‚æ•°è¯´æ˜ï¼š**

- ç¬¬1ä¸ªå‚æ•°ï¼šDemo æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼ˆä½¿ç”¨æ­£æ–œæ  `/`ï¼‰
- ç¬¬2ä¸ªå‚æ•°ï¼šç©å®¶çš„ Steam ID
- ç¬¬3ä¸ªå‚æ•°ï¼šè¦åˆ†æçš„å›åˆå·ï¼ˆä» 1 å¼€å§‹ï¼‰

### ç¬¬å››æ­¥ï¼šéªŒè¯æ•°æ®

è¿è¡Œå®Œæˆåï¼ŒéªŒè¯æ•°æ®æ˜¯å¦æ­£ç¡®ç”Ÿæˆï¼š

```bash
# æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è®­ç»ƒæ•°æ®
node out/cli.js query-training --limit 5

# æ£€æŸ¥ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶
ls D:/myprogram/cs_learning/dataset/1/training_data/*/round_*/frames/*.jpg
```

**ä½¿ç”¨æ•°æ®éªŒè¯è„šæœ¬ï¼ˆæ¨èï¼‰ï¼š**

```bash
node scripts/validate-training-data.mjs <checksum> <player_steam_id> <round_number>

# ç¤ºä¾‹
node scripts/validate-training-data.mjs c6c0a055158ff5fe 76561199138765870 1
```

éªŒè¯è„šæœ¬ä¼šæ£€æŸ¥ï¼š

- âœ… æ•°æ®åº“è®°å½•å®Œæ•´æ€§
- âœ… çª—å£ç´¢å¼•è¿ç»­æ€§
- âœ… Tick èŒƒå›´æœ‰æ•ˆæ€§
- âœ… å›¾ç‰‡æ–‡ä»¶å­˜åœ¨æ€§
- âœ… å›¾ç‰‡æ•°é‡æ­£ç¡®æ€§
- âœ… æ•°æ®å­—æ®µæœ‰æ•ˆæ€§

---

## ç³»ç»Ÿé…ç½®è¯¦æƒ…

### 1. æ•°æ®åº“é…ç½®

**è¿æ¥ä¿¡æ¯ï¼š**

```javascript
Host: 127.0.0.1
Port: 5432
User: postgres
Password: 88683139
Database: csdm
```

**éªŒè¯è¿æ¥ï¼š**

```bash
export PGPASSWORD='88683139'
psql -h 127.0.0.1 -U postgres -d csdm -c "SELECT COUNT(*) FROM training_windows;"
```

### 2. CS2 æ¸¸æˆé…ç½®

**å®‰è£…è·¯å¾„ï¼š**

```
D:/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/
```

**å…³é”®æ–‡ä»¶ï¼š**

```
game/bin/win64/cs2.exe                    # æ¸¸æˆä¸»ç¨‹åº
game/csgo/csdm/bin/server.dll            # æœåŠ¡å™¨æ’ä»¶
game/csgo/gameinfo.gi                     # æ¸¸æˆé…ç½®ï¼ˆåŒ…å« csgo/csdmï¼‰
```

**éªŒè¯æ’ä»¶ï¼š**

```bash
# æ£€æŸ¥æ’ä»¶æ–‡ä»¶
ls "D:/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/csdm/bin/server.dll"

# æ£€æŸ¥é…ç½®
grep "csgo/csdm" "D:/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/gameinfo.gi"
```

### 3. CLI å·¥å…·é…ç½®

**æ„å»ºå·¥å…·ï¼š**

```bash
cd D:\myprogram\cs_learning\tools\cs-demo-manager
node scripts/build-cli-only.mjs
```

**éªŒè¯æ„å»ºï¼š**

```bash
ls out/cli.js
node out/cli.js --help
```

---

## å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### æ•°æ®æ”¶é›†

```bash
# ğŸš€ æ‰¹é‡å®Œæ•´æµæ°´çº¿ï¼ˆæ¨èï¼è‡ªåŠ¨å¤„ç†æ‰€æœ‰ç©å®¶æ‰€æœ‰å›åˆï¼‰
node scripts/batch-complete-pipeline.mjs "demoè·¯å¾„"
node scripts/batch-complete-pipeline.mjs "demoè·¯å¾„" --players Steam_ID1,Steam_ID2
node scripts/batch-complete-pipeline.mjs "demoè·¯å¾„" --rounds 1,2,3

# ğŸš€ æ™ºèƒ½æ‰¹é‡è®­ç»ƒè„šæœ¬ï¼ˆæœ€é«˜æ•ˆï¼ä¸€æ¬¡å¯åŠ¨CS2å½•åˆ¶å¤šä¸ªå›åˆï¼‰
node scripts/smart-batch-pipeline.mjs "demoè·¯å¾„"
node scripts/smart-batch-pipeline.mjs "demoè·¯å¾„" --batch-size 10  # æ¯æ¬¡å½•åˆ¶10ä¸ªå›åˆ
node scripts/smart-batch-pipeline.mjs "demoè·¯å¾„" --players Steam_ID
node scripts/smart-batch-pipeline.mjs "demoè·¯å¾„" --rounds 1-23

# ğŸŒŸ æ™ºèƒ½è®­ç»ƒè„šæœ¬ï¼ˆè‡ªåŠ¨è·³è¿‡å·²æœ‰æ•°æ®ï¼‰
node scripts/smart-training-pipeline.mjs "demoè·¯å¾„"
node scripts/smart-training-pipeline.mjs "demoè·¯å¾„" --players Steam_ID
node scripts/smart-training-pipeline.mjs "demoè·¯å¾„" --rounds 1,2,3

# æ‰¹é‡å½•åˆ¶ï¼ˆæ‰‹åŠ¨æŒ‡å®šå›åˆï¼‰
node scripts/cli-generate-frames-batch.mjs \
  --checksum abc123 \
  --player Steam_ID \
  --rounds 1,2,3,4,5 \
  --demo "demoè·¯å¾„"

# å®Œæ•´æµæ°´çº¿ï¼ˆå•ä¸ªç©å®¶å•ä¸ªå›åˆï¼‰
node scripts/complete-training-pipeline.mjs "demoè·¯å¾„" Steam_ID å›åˆå·

# åˆ†æ­¥æ‰§è¡Œ - æ­¥éª¤1ï¼šå¯¼å‡ºå…ƒæ•°æ®
node out/cli.js training-data "demoè·¯å¾„" --players Steam_ID --rounds 1

# åˆ†æ­¥æ‰§è¡Œ - æ­¥éª¤2ï¼šæŸ¥è¯¢ checksum
node out/cli.js query-training --limit 1

# åˆ†æ­¥æ‰§è¡Œ - æ­¥éª¤3ï¼šå½•åˆ¶å¸§ï¼ˆå•ä¸ªå›åˆï¼‰
node scripts/cli-generate-frames.mjs --checksum abc123 --player Steam_ID --round 1 --demo "demoè·¯å¾„"
```

### æ•°æ®æŸ¥è¯¢

```bash
# æŸ¥è¯¢æ‰€æœ‰è®­ç»ƒæ•°æ®
node out/cli.js query-training

# æŸ¥è¯¢å‰ N ä¸ªçª—å£
node out/cli.js query-training --limit 10

# æŸ¥è¯¢ç‰¹å®šç©å®¶
node out/cli.js query-training --player 76561199138765870

# æŸ¥è¯¢æ•°æ®åº“ç»Ÿè®¡
export PGPASSWORD='88683139'
psql -h 127.0.0.1 -U postgres -d csdm -c "SELECT COUNT(*) FROM training_windows;"
```

### æ‰¹é‡å¤„ç†

```bash
# æ‰¹é‡å¤„ç†å¤šä¸ªå›åˆ
for round in 1 2 3 4 5; do
  node scripts/complete-training-pipeline.mjs "demo.dem" 76561199138765870 $round
done

# æ‰¹é‡å¤„ç†å¤šä¸ªç©å®¶
for player in 76561198000000001 76561198000000002; do
  node scripts/complete-training-pipeline.mjs "demo.dem" $player 1
done
```

---

## è¾“å‡ºæ•°æ®ç»“æ„

### ç›®å½•ç»“æ„

```
dataset/1/training_data/
â””â”€â”€ {player_name}_{steam_id}/
    â””â”€â”€ round_{N}/
        â””â”€â”€ frames/
            â”œâ”€â”€ frame_0001.jpg    # çª—å£1 èµ·å§‹å¸§
            â”œâ”€â”€ frame_0002.jpg    # çª—å£1 ç¬¬2å¸§
            â”œâ”€â”€ ...
            â”œâ”€â”€ frame_0010.jpg    # çª—å£1 ç»“æŸå¸§
            â”œâ”€â”€ frame_0011.jpg    # çª—å£2 èµ·å§‹å¸§
            â””â”€â”€ ...
```

### æ•°æ®åº“è®°å½•æ ¼å¼

æ¯ä¸ªæ—¶é—´çª—å£ï¼ˆ400msï¼Œ10å¸§ï¼‰åŒ…å«ï¼š

```sql
-- å›¾ç‰‡è·¯å¾„
start_frame_path      VARCHAR   -- èµ·å§‹å¸§è·¯å¾„
middle_frame_paths    TEXT      -- ä¸­é—´8å¸§è·¯å¾„ï¼ˆJSONæ•°ç»„ï¼‰
end_frame_path        VARCHAR   -- ç»“æŸå¸§è·¯å¾„

-- ç©å®¶çŠ¶æ€
pos_x, pos_y, pos_z   DOUBLE    -- ç©å®¶ä½ç½®åæ ‡
view_pitch, view_yaw  DOUBLE    -- è§†è§’æ–¹å‘
health, armor         INTEGER   -- ç”Ÿå‘½å€¼ã€æŠ¤ç”²
weapon                VARCHAR   -- å½“å‰æ­¦å™¨
money                 INTEGER   -- é‡‘é’±

-- ç§»åŠ¨çŠ¶æ€
is_moving             BOOLEAN   -- æ˜¯å¦ç§»åŠ¨
move_direction        VARCHAR   -- ç§»åŠ¨æ–¹å‘ï¼ˆW/A/S/D/WA/WD/SA/SDï¼‰
move_speed            DOUBLE    -- ç§»åŠ¨é€Ÿåº¦

-- è¡Œä¸ºçŠ¶æ€
is_crouching          BOOLEAN   -- æ˜¯å¦è¹²ä¸‹
is_scoped             BOOLEAN   -- æ˜¯å¦å¼€é•œ
is_defusing           BOOLEAN   -- æ˜¯å¦æ‹†å¼¹
is_planting           BOOLEAN   -- æ˜¯å¦ä¸‹åŒ…
flash_duration        DOUBLE    -- é—ªå…‰æŒç»­æ—¶é—´

-- æ–‡æœ¬æè¿°
situation_text        TEXT      -- ä¸­æ–‡æƒ…å†µæè¿°
events_json           TEXT      -- äº‹ä»¶åˆ—è¡¨ï¼ˆJSONï¼‰
events_zh             TEXT      -- ä¸­æ–‡äº‹ä»¶æè¿°
```

---

## æ‰‹åŠ¨å®‰è£… CS2 æœåŠ¡å™¨æ’ä»¶

å¦‚æœè‡ªåŠ¨å®‰è£…è„šæœ¬ (`node scripts/install-plugin.mjs`) å¤±è´¥ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨å®‰è£…ï¼š

**é‡è¦è¯´æ˜ï¼š**
- âœ… æ’ä»¶æºæ–‡ä»¶åœ¨ï¼š**CS Demo Manager å®‰è£…ç›®å½•**
- âœ… æ’ä»¶ç›®æ ‡ä½ç½®åœ¨ï¼š**CS2 æ¸¸æˆç›®å½•**
- âœ… ä¸¤ä¸ªæ˜¯å®Œå…¨ä¸åŒçš„ä½ç½®ï¼

---

### æ­¥éª¤ 1ï¼šå®šä½æ’ä»¶æºæ–‡ä»¶ï¼ˆä» CSDM å®‰è£…ç›®å½•ï¼‰

æ’ä»¶æ–‡ä»¶ä½äº CS Demo Manager å®‰è£…ç›®å½•ï¼š

```
C:\Users\<ä½ çš„ç”¨æˆ·å>\AppData\Local\Programs\cs-demo-manager\resources\static\cs2\server.dll
```

æˆ–è€…ä»é¡¹ç›®æ„å»ºè¾“å‡ºä¸­è·å–ï¼ˆå¦‚æœä½ ä»æºç æ„å»ºï¼‰ã€‚

### æ­¥éª¤ 2ï¼šåˆ›å»ºç›®æ ‡ç›®å½•ï¼ˆåœ¨ CS2 æ¸¸æˆç›®å½•ï¼‰

åœ¨ **CS2 æ¸¸æˆç›®å½•**ä¸­åˆ›å»º `csdm/bin` æ–‡ä»¶å¤¹ï¼š

```bash
mkdir -p "/d/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/csdm/bin"
```

### æ­¥éª¤ 3ï¼šå¤åˆ¶æ’ä»¶æ–‡ä»¶ï¼ˆä» CSDM åˆ° CS2ï¼‰

å°† `server.dll` ä» CSDM å®‰è£…ç›®å½•å¤åˆ¶åˆ° CS2 æ¸¸æˆç›®å½•ï¼š

```bash
cp "C:/Users/<ä½ çš„ç”¨æˆ·å>/AppData/Local/Programs/cs-demo-manager/resources/static/cs2/server.dll" \
   "/d/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/csdm/bin/"
```

### æ­¥éª¤ 4ï¼šä¿®æ”¹ gameinfo.giï¼ˆåœ¨ CS2 æ¸¸æˆç›®å½•ï¼‰

ç¼–è¾‘ **CS2 æ¸¸æˆç›®å½•**ä¸­çš„é…ç½®æ–‡ä»¶ï¼š

```
D:\Program Files (x86)\Steam\steamapps\common\Counter-Strike Global Offensive\game\csgo\gameinfo.gi
```

åœ¨ `SearchPaths` éƒ¨åˆ†æ·»åŠ ï¼ˆé€šå¸¸åœ¨ç¬¬ 19 è¡Œé™„è¿‘ï¼‰ï¼š

```
Game	csgo/csdm
```

å®Œæ•´ç¤ºä¾‹ï¼š

```
SearchPaths
{
    Game_LowViolence    csgo_lv
    Game                csgo
    Game                csgo/csdm     // â† æ·»åŠ è¿™ä¸€è¡Œ
    Game                core
    Mod                 csgo
    ...
}
```

### æ­¥éª¤ 5ï¼šéªŒè¯å®‰è£…

```bash
# æ£€æŸ¥æ’ä»¶æ–‡ä»¶
ls "/d/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/csdm/bin/server.dll"

# æ£€æŸ¥é…ç½®
grep "csgo/csdm" "/d/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/gameinfo.gi"
```

å¦‚æœä¸¤ä¸ªå‘½ä»¤éƒ½æˆåŠŸï¼Œè¯´æ˜æ’ä»¶å·²æ­£ç¡®å®‰è£…ã€‚

### ç›®å½•ç»“æ„è¯´æ˜

**ä¸¤ä¸ªé‡è¦ç›®å½•çš„åŒºåˆ«ï¼š**

```
ğŸ“ CS Demo Manager å®‰è£…ç›®å½•ï¼ˆæ’ä»¶æºæ–‡ä»¶ä½ç½®ï¼‰
C:\Users\<ç”¨æˆ·å>\AppData\Local\Programs\cs-demo-manager\
â””â”€â”€ resources\
    â””â”€â”€ static\
        â””â”€â”€ cs2\
            â””â”€â”€ server.dll  â† æºæ–‡ä»¶åœ¨è¿™é‡Œ

ğŸ“ CS2 æ¸¸æˆç›®å½•ï¼ˆæ’ä»¶å®‰è£…ç›®æ ‡ä½ç½®ï¼‰
D:\Program Files (x86)\Steam\steamapps\common\Counter-Strike Global Offensive\
â””â”€â”€ game\
    â”œâ”€â”€ bin\
    â”‚   â””â”€â”€ win64\
    â”‚       â””â”€â”€ cs2.exe  â† CS2 ä¸»ç¨‹åº
    â””â”€â”€ csgo\
        â”œâ”€â”€ csdm\  â† æˆ‘ä»¬åˆ›å»ºçš„æ–‡ä»¶å¤¹
        â”‚   â””â”€â”€ bin\
        â”‚       â””â”€â”€ server.dll  â† æ’ä»¶è¦å¤åˆ¶åˆ°è¿™é‡Œ
        â””â”€â”€ gameinfo.gi  â† é…ç½®æ–‡ä»¶è¦ä¿®æ”¹è¿™ä¸ª
```

**è®°ä½ï¼š**
- ä» CSDM ç›®å½•**è¯»å–**æºæ–‡ä»¶
- å¾€ CS2 ç›®å½•**å†™å…¥**æ’ä»¶æ–‡ä»¶å’Œé…ç½®

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹ï¼ˆå¿…è¯»ï¼ï¼‰

### 1. Demo æ–‡ä»¶è·¯å¾„ç®¡ç†

**é—®é¢˜ï¼š** Demo æ–‡ä»¶è·¯å¾„ä¸æ•°æ®åº“è®°å½•ä¸ä¸€è‡´ä¼šå¯¼è‡´å½•åˆ¶å¤±è´¥ã€‚

**æœ€ä½³å®è·µï¼š**
- âœ… å°† demo æ–‡ä»¶é›†ä¸­å­˜æ”¾åœ¨å›ºå®šç›®å½•
- âœ… ä¸è¦éšæ„ç§»åŠ¨æˆ–é‡å‘½å demo æ–‡ä»¶
- âœ… å¦‚æœç§»åŠ¨äº† demo æ–‡ä»¶ï¼Œéœ€è¦æ›´æ–°æ•°æ®åº“è·¯å¾„

**å¦‚æœ demo æ–‡ä»¶è¢«ç§»åŠ¨äº†ï¼š**

```bash
# 1. æŸ¥è¯¢å½“å‰æ•°æ®åº“è·¯å¾„
export PGPASSWORD='88683139'
psql -h 127.0.0.1 -U postgres -d csdm -c \
  "SELECT demo_path FROM matches WHERE checksum = '<your_checksum>';"

# 2. æ›´æ–°ä¸ºæ–°è·¯å¾„
psql -h 127.0.0.1 -U postgres -d csdm -c \
  "UPDATE matches SET demo_path = '<æ–°è·¯å¾„>' WHERE checksum = '<your_checksum>';"

# ç¤ºä¾‹ï¼š
psql -h 127.0.0.1 -U postgres -d csdm -c \
  "UPDATE matches SET demo_path = 'D:\\new\\path\\demo.dem' WHERE checksum = 'c6c0a055158ff5fe';"
```

**æ³¨æ„ï¼š** æ•°æ®åº“è·¯å¾„ä½¿ç”¨åæ–œæ  `\` éœ€è¦è½¬ä¹‰ä¸º `\\`ã€‚

---

### 2. è‡ªå®šä¹‰å›¾ç‰‡è¾“å‡ºè·¯å¾„

**é»˜è®¤è¡Œä¸ºï¼š** å›¾ç‰‡ä¿å­˜åœ¨ demo æ–‡ä»¶æ‰€åœ¨ç›®å½•çš„ `training_data` å­ç›®å½•ã€‚

**è‡ªå®šä¹‰è¾“å‡ºè·¯å¾„ï¼š** ä½¿ç”¨ `--output` å‚æ•°

**ç¤ºä¾‹1ï¼šå¯¼å‡ºå…ƒæ•°æ®åˆ°Fç›˜**
```bash
node out/cli.js training-data "demo.dem" --output "F:\\cs_data\\traindata"
```

**ç¤ºä¾‹2ï¼šæ‰¹é‡å½•åˆ¶åˆ°Fç›˜**
```bash
node scripts/smart-batch-pipeline.mjs "demo.dem" \
  --batch-size 30 \
  --output "F:\\cs_data\\traindata"
```

**è·¯å¾„æ ¼å¼è¯´æ˜ï¼š**
- Windowså‘½ä»¤è¡Œï¼šä½¿ç”¨åŒåæ–œæ  `\\`
  ä¾‹å¦‚ï¼š`"F:\\cs_data\\traindata"`
- æˆ–è€…ä½¿ç”¨æ­£æ–œæ ï¼ˆæ¨èï¼‰ï¼š`"F:/cs_data/traindata"`
- æ•°æ®åº“ä¸­ï¼šè‡ªåŠ¨è½¬æ¢ä¸ºå•åæ–œæ  `\`

---

### 3. æ‰¹é‡å¤§å°ï¼ˆBatch-Sizeï¼‰ä¼˜åŒ–å»ºè®®

**é—®é¢˜ï¼š** batch-size å¤ªå°ä¼šå¯¼è‡´é¢‘ç¹å¯åŠ¨ CS2ï¼Œæ•ˆç‡ä½ä¸‹ã€‚

**æ¨èé…ç½®ï¼š**

| batch-size | å•æ¬¡å½•åˆ¶æ—¶é—´ | CS2å¯åŠ¨æ¬¡æ•° | æ¨èåœºæ™¯ |
|-----------|------------|-----------|----------|
| 5 | ~2 åˆ†é’Ÿ | å¤šæ¬¡ | æµ‹è¯•ç¯å¢ƒ |
| 10 | ~5 åˆ†é’Ÿ | ä¸­ç­‰ | é»˜è®¤ï¼ˆç¨³å®šï¼‰ |
| **23+** | **~12 åˆ†é’Ÿ** | **æœ€å°‘** | **å¼ºçƒˆæ¨è** â­ |

**ä¸ºä»€ä¹ˆæ¨è batch-size â‰¥ 23ï¼š**
- âœ… æ¯ä¸ªç©å®¶ä¸€æ¬¡æ€§å½•å®Œæ‰€æœ‰å›åˆ
- âœ… 10ä¸ªç©å®¶ Ã— 1æ‰¹ = åªéœ€å¯åŠ¨10æ¬¡CS2
- âœ… èŠ‚çœ 80% çš„å¯åŠ¨æ—¶é—´
- âœ… å‡å°‘å´©æºƒé£é™©

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# ä¸€æ¬¡æ€§å½•å®Œï¼ˆæ¨èï¼‰
node scripts/smart-batch-pipeline.mjs "demo.dem" --batch-size 30
```

---

### 4. Windows è·¯å¾„æ ¼å¼æ³¨æ„

**ä¸‰ç§è·¯å¾„æ ¼å¼ï¼š**

1. **æ•°æ®åº“ä¸­çš„è·¯å¾„**ï¼ˆå•åæ–œæ ï¼‰ï¼š
   ```
   D:\myprogram\cs_learning\demo.dem
   ```

2. **å‘½ä»¤è¡Œå‚æ•°**ï¼ˆåŒåæ–œæ æˆ–æ­£æ–œæ ï¼‰ï¼š
   ```bash
   # æ–¹å¼1ï¼šåŒåæ–œæ ï¼ˆè½¬ä¹‰ï¼‰
   node out/cli.js training-data "D:\\myprogram\\cs_learning\\demo.dem"

   # æ–¹å¼2ï¼šæ­£æ–œæ ï¼ˆæ¨èï¼Œæ›´å®‰å…¨ï¼‰
   node out/cli.js training-data "D:/myprogram/cs_learning/demo.dem"
   ```

3. **SQL æŸ¥è¯¢ä¸­çš„è·¯å¾„**ï¼ˆåæ–œæ éœ€è½¬ä¹‰ï¼‰ï¼š
   ```sql
   UPDATE matches SET demo_path = 'D:\\new\\path\\demo.dem' WHERE checksum = 'xxx';
   ```

---

### 5. å½•åˆ¶å‰æ£€æŸ¥æ¸…å•

åœ¨å¯åŠ¨æ‰¹é‡å½•åˆ¶å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] âœ… Steam å®¢æˆ·ç«¯å·²å¯åŠ¨å¹¶ç™»å½•
- [ ] âœ… Demo æ–‡ä»¶è·¯å¾„æ­£ç¡®ä¸”æœªè¢«ç§»åŠ¨
- [ ] âœ… æ•°æ®åº“è·¯å¾„ä¸å®é™…æ–‡ä»¶è·¯å¾„ä¸€è‡´
- [ ] âœ… è¾“å‡ºç›®å½•æœ‰è¶³å¤Ÿç£ç›˜ç©ºé—´ï¼ˆå»ºè®® > 50GBï¼‰
- [ ] âœ… PostgreSQL æœåŠ¡è¿è¡Œæ­£å¸¸
- [ ] âœ… batch-size è®¾ç½®åˆç†ï¼ˆæ¨è â‰¥ 23ï¼‰
- [ ] âœ… è¾“å‡ºè·¯å¾„å·²æ­£ç¡®é…ç½®ï¼ˆå¦‚éœ€è‡ªå®šä¹‰ï¼‰

**å¿«é€ŸéªŒè¯å‘½ä»¤ï¼š**
```bash
# 1. æ£€æŸ¥ Steam
tasklist | findstr -i "steam.exe"

# 2. æ£€æŸ¥ Demo æ–‡ä»¶
ls "D:/path/to/demo.dem"

# 3. æ£€æŸ¥æ•°æ®åº“è¿æ¥
export PGPASSWORD='88683139'
psql -h 127.0.0.1 -U postgres -d csdm -c "SELECT version();"

# 4. æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h F:/
```

---

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šCS2 æ— æ³•å¯åŠ¨æˆ–å¯åŠ¨å¤±è´¥

**ç—‡çŠ¶ï¼š** è„šæœ¬æ˜¾ç¤ºå¯åŠ¨ CS2ï¼Œä½†æ¸¸æˆæ²¡æœ‰æ‰“å¼€

**å¯èƒ½åŸå› ï¼š**

1. **Steam å®¢æˆ·ç«¯æœªè¿è¡Œ**ï¼ˆæœ€å¸¸è§ï¼‰
2. CS2 è·¯å¾„é…ç½®é”™è¯¯
3. Steam æœªç™»å½•

**è§£å†³æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥ Steam æ˜¯å¦è¿è¡Œ
tasklist | findstr -i "steam.exe"

# å¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œå¯åŠ¨ Steamï¼š
# æ‰“å¼€ Steam å®¢æˆ·ç«¯å¹¶ç™»å½•

# 2. ç¡®è®¤ Steam å·²ç™»å½•åé‡è¯•
```

### é—®é¢˜ 2ï¼šCS2 å¯åŠ¨åä¸è¿›å…¥å›æ”¾

**ç—‡çŠ¶ï¼š** æ¸¸æˆå¯åŠ¨ä½†åœç•™åœ¨ä¸»èœå•

**å¯èƒ½åŸå› ï¼š**

1. æœåŠ¡å™¨æ’ä»¶æœªæ­£ç¡®åŠ è½½
2. gameinfo.gi é…ç½®é”™è¯¯
3. JSON å‘½ä»¤æ–‡ä»¶æ ¼å¼é”™è¯¯

**è§£å†³æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥æ’ä»¶æ–‡ä»¶
ls "D:/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/csdm/bin/server.dll"

# 2. æ£€æŸ¥ gameinfo.gi
grep -i "csgo/csdm" "D:/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/gameinfo.gi"

# è¾“å‡ºåº”åŒ…å«ï¼šGame	csgo/csdm

# 3. æ£€æŸ¥ JSON æ–‡ä»¶æ ¼å¼
# æŸ¥æ‰¾æœ€è¿‘çš„ JSON æ–‡ä»¶
ls -lt D:/myprogram/cs_learning/dataset/1/*.json | head -1
```

### é—®é¢˜ 2ï¼šå›¾ç‰‡æ–‡ä»¶ç¼ºå¤±æˆ–æ•°é‡ä¸å¯¹

**ç—‡çŠ¶ï¼š** æ•°æ®åº“æœ‰è®°å½•ä½†å›¾ç‰‡æ–‡ä»¶ä¸å­˜åœ¨

**å¯èƒ½åŸå› ï¼š**

1. CS2 å½•åˆ¶è¢«ä¸­æ–­
2. å›¾ç‰‡è·¯å¾„é…ç½®é”™è¯¯
3. ç£ç›˜ç©ºé—´ä¸è¶³

**è§£å†³æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥ CS2 ç”Ÿæˆçš„ä¸´æ—¶å›¾ç‰‡
ls "D:/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/csdm/movie/"

# 2. æ£€æŸ¥ç›®æ ‡ç›®å½•æƒé™
ls -ld D:/myprogram/cs_learning/dataset/1/training_data/

# 3. é‡æ–°è¿è¡Œæµæ°´çº¿
node scripts/complete-training-pipeline.mjs "demo.dem" Steam_ID å›åˆå·
```

### é—®é¢˜ 3ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

**ç—‡çŠ¶ï¼š** æç¤ºæ— æ³•è¿æ¥åˆ°æ•°æ®åº“

**å¯èƒ½åŸå› ï¼š**

1. PostgreSQL æœåŠ¡æœªå¯åŠ¨
2. å¯†ç é”™è¯¯
3. æ•°æ®åº“ä¸å­˜åœ¨

**è§£å†³æ­¥éª¤ï¼š**

```bash
# 1. æµ‹è¯•è¿æ¥
export PGPASSWORD='88683139'
psql -h 127.0.0.1 -U postgres -d csdm -c "SELECT version();"

# 2. æ£€æŸ¥ PostgreSQL æœåŠ¡
# åœ¨ Windows æœåŠ¡ç®¡ç†å™¨ä¸­æ£€æŸ¥ postgresql-x64-18 æœåŠ¡çŠ¶æ€

# 3. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å­˜åœ¨
psql -h 127.0.0.1 -U postgres -l | grep csdm
```

### é—®é¢˜ 4ï¼šCS2 è¿›ç¨‹æ— æ³•å…³é—­

**ç—‡çŠ¶ï¼š** å½•åˆ¶å®Œæˆå CS2 è¿›ç¨‹ä»åœ¨è¿è¡Œ

**è§£å†³æ­¥éª¤ï¼š**

```bash
# Windows PowerShell
taskkill /F /IM cs2.exe

# æˆ–è€…ä½¿ç”¨ Git Bash
cmd.exe /c "taskkill /F /IM cs2.exe"
```

### é—®é¢˜ 5ï¼šå½•åˆ¶å‚æ•°é…ç½®é”™è¯¯

**ç—‡çŠ¶ï¼š** å¸§æ•°ä¸å¯¹æˆ–æ—¶é—´çª—å£ä¸ç¬¦åˆé¢„æœŸ

**æ£€æŸ¥é…ç½®ï¼š**

åœ¨ `scripts/cli-generate-frames.mjs` ä¸­ç¡®è®¤ï¼š

```javascript
æ—¶é—´çª—å£ï¼š400ms
å¸§ç‡ï¼š25fps
æ¯çª—å£å¸§æ•°ï¼š10 (400ms Ã— 25fps Ã· 1000)
åˆ†è¾¨ç‡ï¼š1280Ã—720
```

---

## ğŸš€ æ‰¹é‡å½•åˆ¶åŠŸèƒ½ï¼ˆå¼ºçƒˆæ¨èï¼ï¼‰

### ä¸ºä»€ä¹ˆéœ€è¦æ‰¹é‡å½•åˆ¶ï¼Ÿ

**ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š**
- æ¯ä¸ªå›åˆéƒ½è¦å¯åŠ¨/å…³é—­ CS2
- å¯åŠ¨æ¸¸æˆéœ€è¦ 10-15 ç§’
- é¢‘ç¹å¯åŠ¨å®¹æ˜“å¯¼è‡´å´©æºƒï¼ˆaccessviolationï¼‰
- 230 ä¸ªä»»åŠ¡éœ€è¦å¯åŠ¨ CS2 **230 æ¬¡**

**æ‰¹é‡å½•åˆ¶çš„ä¼˜åŠ¿ï¼š**
- âœ… ä¸€æ¬¡å¯åŠ¨ CS2ï¼Œè¿ç»­å½•åˆ¶å¤šä¸ªå›åˆ
- âœ… å‡å°‘ 95% çš„å¯åŠ¨æ—¶é—´æµªè´¹
- âœ… æ˜¾è‘—é™ä½å´©æºƒæ¦‚ç‡
- âœ… å¤„ç† 230 ä¸ªä»»åŠ¡åªéœ€å¯åŠ¨ **23 æ¬¡**ï¼ˆæ¯ä¸ªç©å®¶1æ¬¡ï¼‰

### æ€§èƒ½å¯¹æ¯”

| æ¨¡å¼ | å¯åŠ¨æ¬¡æ•° | æ€»å¯åŠ¨æ—¶é—´ | æ€»å¤„ç†æ—¶é—´ | å´©æºƒæ¦‚ç‡ |
|------|---------|-----------|-----------|---------|
| ä¼ ç»Ÿæ¨¡å¼ | 230 æ¬¡ | ~58 åˆ†é’Ÿ | ~4 å°æ—¶ | é«˜ |
| **æ‰¹é‡æ¨¡å¼** | **23 æ¬¡** | **~6 åˆ†é’Ÿ** | **~30 åˆ†é’Ÿ** | **ä½** |

*åŸºäº 10 ç©å®¶ Ã— 23 å›åˆï¼Œ40x å€é€Ÿ*

### å¿«é€Ÿä½¿ç”¨

**æ¨èç”¨æ³•ï¼ˆå…¨è‡ªåŠ¨ï¼‰ï¼š**
```bash
cd D:\myprogram\cs_learning\tools\cs-demo-manager

# å¤„ç†æ•´ä¸ª demoï¼ˆè‡ªåŠ¨åˆ†ç»„æ‰¹é‡å½•åˆ¶ï¼‰
node scripts/smart-batch-pipeline.mjs "D:/myprogram/cs_learning/dataset/1/match.dem"

# æ¯æ¬¡å½•åˆ¶ 5 ä¸ªå›åˆï¼ˆå‡å°‘å•æ¬¡å¤±è´¥å½±å“ï¼‰
node scripts/smart-batch-pipeline.mjs "demo.dem" --batch-size 5

# åªå¤„ç†ç‰¹å®šç©å®¶
node scripts/smart-batch-pipeline.mjs "demo.dem" --players 76561199138765870
```

**æ‰‹åŠ¨æ‰¹é‡å½•åˆ¶ï¼ˆé«˜çº§ï¼‰ï¼š**
```bash
# å½•åˆ¶ç©å®¶çš„ç¬¬ 1-10 å›åˆ
node scripts/cli-generate-frames-batch.mjs \
  --checksum c6c0a055158ff5fe \
  --player 76561199138765870 \
  --rounds 1-10 \
  --demo "demo.dem"

# å½•åˆ¶ç‰¹å®šå›åˆ
node scripts/cli-generate-frames-batch.mjs \
  --checksum c6c0a055158ff5fe \
  --player 76561199138765870 \
  --rounds 1,5,10,15,20 \
  --demo "demo.dem"
```

### å·¥ä½œæµç¨‹

æ‰¹é‡å½•åˆ¶çš„å†…éƒ¨æµç¨‹ï¼š

1. **åˆ†æé˜¶æ®µ**
   - æ£€æŸ¥å“ªäº›å›åˆéœ€è¦å½•åˆ¶
   - è‡ªåŠ¨è·³è¿‡å·²æœ‰æ•°æ®
   - æŒ‰ç©å®¶åˆ†ç»„

2. **å½•åˆ¶é˜¶æ®µ**ï¼ˆå…³é”®ä¼˜åŒ–ï¼ï¼‰
   ```
   ç©å®¶ A:
     å¯åŠ¨ CS2 â†’ å½•åˆ¶ Round 1 â†’ å½•åˆ¶ Round 2 â†’ ... â†’ å½•åˆ¶ Round 23 â†’ å…³é—­ CS2

   ç©å®¶ B:
     å¯åŠ¨ CS2 â†’ å½•åˆ¶ Round 1 â†’ å½•åˆ¶ Round 2 â†’ ... â†’ å½•åˆ¶ Round 23 â†’ å…³é—­ CS2
   ```

3. **éªŒè¯é˜¶æ®µ**
   - è‡ªåŠ¨éªŒè¯å›¾ç‰‡æ•°é‡
   - è‡ªåŠ¨æ›´æ–°æ•°æ®åº“è·¯å¾„
   - è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶

### æ‰¹é‡å¤§å°å»ºè®®

| batch-size | å•æ¬¡å½•åˆ¶æ—¶é—´ | å¤±è´¥å½±å“ | æ¨èåœºæ™¯ |
|-----------|------------|---------|----------|
| 5 | ~2 åˆ†é’Ÿ | æœ€å° | æµ‹è¯•/ä¸ç¨³å®šç¯å¢ƒ |
| **10** | **~5 åˆ†é’Ÿ** | **å°** | **æ¨èï¼ˆé»˜è®¤ï¼‰** |
| 23 | ~12 åˆ†é’Ÿ | ä¸­ç­‰ | ç¨³å®šç¯å¢ƒ |
| å…¨éƒ¨ | ~20 åˆ†é’Ÿ | æœ€å¤§ | éå¸¸ç¨³å®šç¯å¢ƒ |

**å»ºè®®ï¼š**
- åˆæ¬¡ä½¿ç”¨ï¼š`--batch-size 5`ï¼ˆç¨³å¦¥ï¼‰
- ç¨³å®šåï¼š`--batch-size 10`ï¼ˆé»˜è®¤ï¼‰
- é«˜æ€§èƒ½æœºå™¨ï¼šå¯ä»¥æ›´å¤§

### é¿å… CS2 å´©æºƒçš„æŠ€å·§

æ‰¹é‡å½•åˆ¶å¤©ç„¶å‡å°‘å´©æºƒï¼Œä½†è¿˜å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š

1. **é™ä½æ‰¹é‡å¤§å°**
   ```bash
   node scripts/smart-batch-pipeline.mjs "demo.dem" --batch-size 5
   ```

2. **å…³é—­éŸ³é¢‘**ï¼ˆå·²é»˜è®¤å¯ç”¨ï¼‰
   - è„šæœ¬å·²è®¾ç½® `volume 0`
   - éŸ³é¢‘å¤„ç†å®¹æ˜“å¯¼è‡´å´©æºƒ

3. **æ·»åŠ å¤±è´¥é‡è¯•**
   - æ™ºèƒ½æ‰¹é‡è„šæœ¬å·²å†…ç½®é‡è¯•æœºåˆ¶
   - å¤±è´¥çš„æ‰¹æ¬¡ä¼šè‡ªåŠ¨è·³è¿‡

4. **ç›‘æ§å†…å­˜ä½¿ç”¨**
   ```bash
   # å¦‚æœå†…å­˜ä¸è¶³ï¼Œé™ä½æ‰¹é‡å¤§å°
   node scripts/smart-batch-pipeline.mjs "demo.dem" --batch-size 3
   ```

### å®æ—¶ç›‘æ§

æ‰¹é‡å½•åˆ¶æ—¶çš„è¾“å‡ºç¤ºä¾‹ï¼š
```
æ£€æŸ¥ç©å®¶ -shNz- (76561199138765870)...
  [1/23] Round 1: â­ï¸  å·²å­˜åœ¨ (57 çª—å£, 570 å¸§)
  [2/23] Round 2: ğŸ“ éœ€è¦å½•åˆ¶
  [3/23] Round 3: ğŸ“ éœ€è¦å½•åˆ¶
  ...

ğŸ¬ å¼€å§‹å½•åˆ¶ -shNz- çš„ 22 ä¸ªå›åˆ...

æ‰¹æ¬¡ 1/3: Round 2, 3, 4, 5, 6, 7, 8, 9, 10, 11
  ğŸ“Š å¯¼å‡ºå…ƒæ•°æ®...
    âœ“ å…ƒæ•°æ®å¯¼å‡ºå®Œæˆ
  ğŸ¥ æ‰¹é‡å½•åˆ¶è§†é¢‘å¸§...
    âœ“ æ‰¹é‡å½•åˆ¶å®Œæˆ

æ‰¹æ¬¡ 2/3: Round 12, 13, 14, 15, 16, 17, 18, 19, 20, 21
  ...
```

### æ•…éšœæ¢å¤

å¦‚æœæ‰¹é‡å½•åˆ¶ä¸­é€”å¤±è´¥ï¼š

1. **é‡æ–°è¿è¡Œè„šæœ¬**
   ```bash
   # æ™ºèƒ½è·³è¿‡å·²å®Œæˆçš„å›åˆ
   node scripts/smart-batch-pipeline.mjs "demo.dem"
   ```

2. **æ‰‹åŠ¨è¡¥å½•å¤±è´¥çš„å›åˆ**
   ```bash
   # åªå½•åˆ¶å¤±è´¥çš„å›åˆ
   node scripts/cli-generate-frames-batch.mjs \
     --checksum <checksum> \
     --player <steam_id> \
     --rounds 7,9,10 \
     --demo "demo.dem"
   ```

---

## å½•åˆ¶åŠ é€Ÿä¸æ‰¹å¤„ç†æ§åˆ¶

### ğŸ¯ 1x å€é€Ÿå½•åˆ¶ï¼ˆå½“å‰é…ç½®ï¼‰

ç³»ç»Ÿå½“å‰ä½¿ç”¨ **1x å€é€Ÿ**å½•åˆ¶ï¼Œç¡®ä¿æœ€é«˜ç¨³å®šæ€§ï¼š

| å›åˆæ—¶é•¿ | 1xå€é€Ÿå½•åˆ¶æ—¶é—´ | ç¨³å®šæ€§ | é€‚ç”¨åœºæ™¯ |
|---------|---------------|--------|----------|
| 30ç§’å›åˆ | 3-5 åˆ†é’Ÿ | â­â­â­â­â­ | æœ€ç¨³å®šï¼Œä¸å¡é¡¿ |
| 60ç§’å›åˆ | 5-8 åˆ†é’Ÿ | â­â­â­â­â­ | ç¡®ä¿æ•°æ®è´¨é‡ |
| 90ç§’å›åˆ | 8-12 åˆ†é’Ÿ | â­â­â­â­â­ | é•¿å›åˆä¹Ÿèƒ½ç¨³å®šå½•åˆ¶ |

**é…ç½®ä½ç½®ï¼š** `scripts/cli-generate-frames.mjs:174`

```javascript
{ tick: gotoTick + 5, cmd: 'demo_timescale 1' },  // 1å€é€Ÿå½•åˆ¶
```

**å¦‚æœè¦ä¿®æ”¹å€é€Ÿï¼š**
- `demo_timescale 1`ï¼šåŸé€Ÿï¼ˆå½“å‰è®¾ç½®ï¼Œæœ€ç¨³å®šï¼‰âœ…
- `demo_timescale 2`ï¼š2å€é€Ÿï¼ˆèŠ‚çœ50%æ—¶é—´ï¼‰
- `demo_timescale 1`ï¼š4å€é€Ÿï¼ˆèŠ‚çœ75%æ—¶é—´ï¼Œå¯èƒ½å¡é¡¿ï¼‰
- `demo_timescale 1`ï¼š10å€é€Ÿï¼ˆèŠ‚çœ90%æ—¶é—´ï¼Œä¸æ¨èï¼‰

**âš ï¸ ä¿®æ”¹å€é€Ÿåçš„å½±å“ï¼š**
- å€é€Ÿè¶Šé«˜ï¼ŒCS2è¶Šå®¹æ˜“å¡é¡¿
- å¡é¡¿ä¼šå¯¼è‡´å®é™…å½•åˆ¶æ—¶é—´å˜é•¿ï¼Œåè€Œä¸åˆ’ç®—
- 1xå€é€Ÿè™½ç„¶æ…¢ï¼Œä½†ä¿è¯ä¸ä¸¢å¸§ã€ä¸å¡é¡¿

### ğŸ›‘ åœæ­¢æ‰¹å¤„ç†

**åœæ­¢æ­£åœ¨è¿è¡Œçš„æ‰¹å¤„ç†è„šæœ¬ï¼š**

```bash
# åˆ›å»ºåœæ­¢æ–‡ä»¶
touch /f/cs_data/batch_process.stop

# æˆ–åœ¨ Windows
echo. > F:\cs_data\batch_process.stop
```

è„šæœ¬ä¼šæ£€æµ‹åˆ°åœæ­¢æ–‡ä»¶å¹¶å®‰å…¨ç»ˆæ­¢ï¼ˆå®Œæˆå½“å‰ä»»åŠ¡åï¼‰ã€‚

**æ¸…ç†åœæ­¢æ–‡ä»¶ï¼š**

```bash
rm /f/cs_data/batch_process.stop
```

### ğŸ“¦ æ™ºèƒ½è®­ç»ƒè„šæœ¬ç‰¹æ€§

**æ–‡ä»¶ï¼š** `scripts/smart-training-pipeline.mjs`

**ä¸»è¦åŠŸèƒ½ï¼š**
1. âœ… è‡ªåŠ¨è§£æ demo çš„æ‰€æœ‰ç©å®¶å’Œå›åˆ
2. âœ… æ£€æŸ¥æ•°æ®åº“ + å›¾ç‰‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨
3. âœ… æ™ºèƒ½è·³è¿‡å·²å®Œæˆçš„æ•°æ®
4. âœ… æ”¯æŒæ–­ç‚¹ç»­ä¼ 
5. âœ… æ”¯æŒåœæ­¢æ–‡ä»¶æœºåˆ¶

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```bash
# å¤„ç†æ•´ä¸ª demoï¼ˆè‡ªåŠ¨è·³è¿‡å·²æœ‰æ•°æ®ï¼‰
node scripts/smart-training-pipeline.mjs "demo.dem"

# åªå¤„ç†ç‰¹å®šç©å®¶
node scripts/smart-training-pipeline.mjs "demo.dem" --players 76561199138765870

# åªå¤„ç†ç‰¹å®šå›åˆ
node scripts/smart-training-pipeline.mjs "demo.dem" --rounds 1,2,3,4,5

# å¼ºåˆ¶é‡æ–°ç”Ÿæˆï¼ˆå¿½ç•¥å·²æœ‰æ•°æ®ï¼‰
node scripts/smart-training-pipeline.mjs "demo.dem" --force

# ç»„åˆä½¿ç”¨
node scripts/smart-training-pipeline.mjs "demo.dem" \
  --players 76561199138765870,76561198000000001 \
  --rounds 1,2,3
```

**è¾“å‡ºç¤ºä¾‹ï¼š**

```
[1/230] -shNz- (76561199138765870) - Round 1
  â­ï¸  è·³è¿‡ (å·²æœ‰ 57 ä¸ªçª—å£, 570 å¸§å›¾ç‰‡)

[2/230] -shNz- (76561199138765870) - Round 2
  ğŸ“ å›¾ç‰‡ä¸å®Œæ•´ (450/970)
  âœ… å®Œæˆ

[3/230] -shNz- (76561199138765870) - Round 3
  ğŸ“ æ•°æ®åº“æ— è®°å½•
  âœ… å®Œæˆ
```

---

## é«˜çº§é…ç½®

### ä¿®æ”¹ CS2 å¯åŠ¨è·¯å¾„

å¦‚æœä½ çš„ CS2 å®‰è£…åœ¨å…¶ä»–ä½ç½®ï¼Œéœ€è¦ä¿®æ”¹ï¼š

**æ–‡ä»¶ï¼š** `scripts/cli-generate-frames.mjs`

```javascript
// ç¬¬ 194 è¡Œé™„è¿‘
const cs2Path = 'ä½ çš„CS2è·¯å¾„/cs2.exe';

// ä¾‹å¦‚ï¼š
const cs2Path = 'E:/Games/Steam/steamapps/common/Counter-Strike Global Offensive/game/bin/win64/cs2.exe';
```

### ä¿®æ”¹æ•°æ®åº“é…ç½®

**æ–‡ä»¶ï¼š** `scripts/cli-generate-frames.mjs`

```javascript
// æœç´¢ "Client" é…ç½®
const client = new Client({
  host: '127.0.0.1',      // æ•°æ®åº“åœ°å€
  port: 5432,             // ç«¯å£
  user: 'postgres',       // ç”¨æˆ·å
  password: '88683139',   // å¯†ç 
  database: 'csdm',       // æ•°æ®åº“å
});
```

### ä¿®æ”¹å½•åˆ¶å‚æ•°

**æ–‡ä»¶ï¼š** `scripts/cli-generate-frames.mjs`

```javascript
// æœç´¢å½•åˆ¶å‚æ•°é…ç½®
const windowMs = 400;          // æ—¶é—´çª—å£ï¼ˆæ¯«ç§’ï¼‰
const fps = 25;                // å¸§ç‡
const framesPerWindow = 10;    // æ¯çª—å£å¸§æ•°
```

### ä¿®æ”¹å›¾ç‰‡åˆ†è¾¨ç‡ â­

**é»˜è®¤åˆ†è¾¨ç‡ï¼š** **640Ã—480**ï¼ˆå·²ä¼˜åŒ–ï¼Œé€‚åˆæ·±åº¦å­¦ä¹ è®­ç»ƒï¼‰

**ä¸ºä»€ä¹ˆé€‰æ‹© 640Ã—480ï¼š**
- âœ… æ–‡ä»¶å¤§å°é€‚ä¸­ï¼ˆçº¦ 30-80 KB/å¸§ï¼‰
- âœ… è®­ç»ƒé€Ÿåº¦å¿«
- âœ… ä¿ç•™è¶³å¤Ÿçš„è§†è§‰ä¿¡æ¯
- âœ… æ ‡å‡†çš„ 4:3 æ¯”ä¾‹

**ä¿®æ”¹æ–¹æ³•ï¼š**

**æ–‡ä»¶ï¼š** `scripts/cli-generate-frames.mjs:200-201`

```javascript
const launchArgs = [
  '-insecure',
  '-novid',
  '-sw',
  '-width 640',   // å®½åº¦
  '-height 480',  // é«˜åº¦
  `+playdemo "${demoPath}"`,
].join(' ');
```

**å¸¸ç”¨åˆ†è¾¨ç‡é€‰é¡¹ï¼š**

| åˆ†è¾¨ç‡ | æ¯”ä¾‹ | æ–‡ä»¶å¤§å° | ç”¨é€” | æ¨è |
|--------|------|----------|------|------|
| 640Ã—480 | 4:3 | ~30-80 KB | æ·±åº¦å­¦ä¹ è®­ç»ƒ | â­â­â­â­â­ |
| 1280Ã—720 | 16:9 | ~80-200 KB | é«˜è´¨é‡è®­ç»ƒ | â­â­â­ |
| 1920Ã—1080 | 16:9 | ~150-400 KB | å…¨é«˜æ¸…å±•ç¤º | â­â­ |
| 320Ã—240 | 4:3 | ~10-30 KB | æé€Ÿè®­ç»ƒ/æµ‹è¯• | â­â­ |

**âš ï¸ ä¿®æ”¹åˆ†è¾¨ç‡åéœ€è¦ï¼š**
1. åœæ­¢å½“å‰æ‰¹å¤„ç†ï¼ˆ`touch /f/cs_data/batch_process.stop`ï¼‰
2. åˆ é™¤æ—§åˆ†è¾¨ç‡çš„æ•°æ®
3. é‡æ–°å¯åŠ¨æ‰¹å¤„ç†

### å€é€Ÿæµ‹è¯•å†å²ï¼ˆä»…ä¾›å‚è€ƒï¼‰

**ä¸åŒå€é€Ÿçš„æµ‹è¯•ç»“æœï¼š**

| å€é€Ÿ | 30ç§’å›åˆå½•åˆ¶æ—¶é—´ | 60ç§’å›åˆå½•åˆ¶æ—¶é—´ | ç¨³å®šæ€§ | å¡é¡¿æƒ…å†µ |
|------|---------------|---------------|--------|---------|
| **1x** | 3-5 åˆ†é’Ÿ | 5-8 åˆ†é’Ÿ | â­â­â­â­â­ | æ— å¡é¡¿ âœ… |
| 2x | 2-3 åˆ†é’Ÿ | 3-5 åˆ†é’Ÿ | â­â­â­â­ | å¶å°”å¡é¡¿ |
| 4x | 1-2 åˆ†é’Ÿ | 2-3 åˆ†é’Ÿ | â­â­â­ | ç»å¸¸å¡é¡¿ âš ï¸ |
| 10x | 30-60 ç§’ | 1-2 åˆ†é’Ÿ | â­â­ | ä¸¥é‡å¡é¡¿ âŒ |
| 40x | 10-20 ç§’ | 20-40 ç§’ | â­ | æåº¦å¡é¡¿ âŒ |

**æµ‹è¯•ç»“è®ºï¼š**
- âœ… **1xå€é€Ÿæœ€ç¨³å®š**ï¼šè™½ç„¶æ…¢ï¼Œä½†ä¿è¯ä¸ä¸¢å¸§ã€æ•°æ®è´¨é‡æœ€é«˜
- âš ï¸ 4x+å€é€Ÿï¼šè™½ç„¶èƒ½å½•å®Œï¼Œä½†å¡é¡¿å¯¼è‡´å®é™…æ—¶é—´åè€Œæ›´é•¿
- âŒ 10x+å€é€Ÿï¼šå¡é¡¿ä¸¥é‡ï¼Œå®é™…å½•åˆ¶æ—¶é—´å¯èƒ½è¶…è¿‡1xå€é€Ÿ

**ä¸ºä»€ä¹ˆé€‰æ‹©1xå€é€Ÿï¼š**
- ğŸ¯ é¿å…å¡é¡¿å¯¼è‡´å½•åˆ¶å¤±è´¥
- ğŸ¯ ç¡®ä¿æ¯ä¸€å¸§éƒ½å‡†ç¡®è®°å½•
- ğŸ¯ ç¨³å®šæ€§ > é€Ÿåº¦ï¼ˆå¤±è´¥é‡å½•æµªè´¹æ›´å¤šæ—¶é—´ï¼‰

### å…¶ä»–é«˜çº§é…ç½®

**1. Xå…‰æ¨¡å¼æ§åˆ¶**

**æ–‡ä»¶ï¼š** `scripts/cli-generate-frames.mjs:172`

```javascript
{ tick: 1, cmd: 'spec_show_xray 0' },  // 0=å…³é—­ï¼Œ1=å¼€å¯
```

**2. å½•åˆ¶æ ¼å¼**

å½“å‰ä½¿ç”¨ JPG æ ¼å¼ã€‚å¦‚éœ€ PNGï¼ˆæ— æŸï¼‰ï¼š

```javascript
{ tick: setupTick, cmd: `startmovie "frames" png` },
```

**æ³¨æ„ï¼š** PNG æ–‡ä»¶å¤§å°çº¦ä¸º JPG çš„ 3-5 å€ã€‚

**3. è§†è§’æ¨¡å¼**

**æ–‡ä»¶ï¼š** `scripts/cli-generate-frames.mjs:175`

```javascript
{ tick: 1, cmd: 'spec_mode 1' },  // 1=ç¬¬ä¸€äººç§°ï¼Œ4=è‡ªç”±è§†è§’ï¼Œ5=ç¬¬ä¸‰äººç§°
```

**4. æ‰¹å¤„ç†ä¼˜å…ˆçº§**

Windows ç”¨æˆ·å¯ä»¥é™ä½ CS2 è¿›ç¨‹ä¼˜å…ˆçº§ï¼Œé¿å…ç³»ç»Ÿå¡é¡¿ï¼š

```bash
# åœ¨å¯åŠ¨ CS2 åè¿è¡Œ
wmic process where name="cs2.exe" CALL setpriority "below normal"
```

---

## æ•°æ®ä½¿ç”¨ç¤ºä¾‹

### Python æ•°æ®åŠ è½½

**å®‰è£…ä¾èµ–ï¼š**

```bash
pip install psycopg2-binary pillow numpy torch torchvision
```

**åŸºç¡€ä½¿ç”¨ï¼š**

```python
from scripts.cs2_training_loader import CS2TrainingDataset

# åˆ›å»ºæ•°æ®é›†
dataset = CS2TrainingDataset(
    db_config={
        'host': '127.0.0.1',
        'port': 5432,
        'user': 'postgres',
        'password': '88683139',
        'database': 'csdm'
    }
)

# åŠ è½½æ ·æœ¬
sample = dataset[0]
print(f"Frames shape: {sample['frames'].shape}")    # (10, H, W, 3)
print(f"Situation: {sample['situation']}")
print(f"Events: {sample['events']}")
print(f"Position: ({sample['pos_x']}, {sample['pos_y']}, {sample['pos_z']})")
```

### PyTorch è®­ç»ƒç¤ºä¾‹

```python
from torch.utils.data import DataLoader
from torchvision import transforms

# æ•°æ®é¢„å¤„ç†
transform = transforms.Compose([
    transforms.Resize((224, 224)),
    transforms.ToTensor(),
    transforms.Normalize(
        mean=[0.485, 0.456, 0.406],
        std=[0.229, 0.224, 0.225]
    ),
])

# åˆ›å»ºæ•°æ®åŠ è½½å™¨
dataset = CS2TrainingDataset(db_config={...}, transform=transform)
dataloader = DataLoader(dataset, batch_size=16, shuffle=True, num_workers=4)

# è®­ç»ƒå¾ªç¯
for batch in dataloader:
    frames = batch['frames']          # (B, 10, 3, 224, 224)
    situation = batch['situation']    # (B,)
    events = batch['events']          # (B, N)

    # ä½ çš„æ¨¡å‹è®­ç»ƒä»£ç ...
```

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ‰¹é‡å¤„ç†

å¯¹äºå¤§é‡ demo æ–‡ä»¶ï¼Œå»ºè®®ä½¿ç”¨è„šæœ¬æ‰¹é‡å¤„ç†ï¼š

```bash
#!/bin/bash
demos=(
  "D:/demos/match1.dem"
  "D:/demos/match2.dem"
  "D:/demos/match3.dem"
)

players=(76561199138765870 76561198000000001)

for demo in "${demos[@]}"; do
  for player in "${players[@]}"; do
    for round in {1..10}; do
      node scripts/complete-training-pipeline.mjs "$demo" "$player" "$round"
      sleep 5  # é¿å…è¿‡å¿«å¯åŠ¨ CS2
    done
  done
done
```

### 2. ç£ç›˜ç©ºé—´ç®¡ç†

**é¢„ä¼°èµ„æºæ¶ˆè€—ï¼š**

- æ¯å›åˆæ—¶é•¿ï¼š30-60 ç§’
- æ¯å›åˆçª—å£æ•°ï¼š50-100 ä¸ª
- æ¯çª—å£å¸§æ•°ï¼š10 å¸§
- æ¯å¸§å¤§å°ï¼š50-200 KB
- **æ€»ç£ç›˜å ç”¨ï¼š25-200 MB/å›åˆ**

**æ¸…ç†å»ºè®®ï¼š**

```bash
# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
rm -rf "D:/Program Files (x86)/Steam/steamapps/common/Counter-Strike Global Offensive/game/csgo/csdm/movie/"*

# æ¸…ç†æ—§çš„è®­ç»ƒæ•°æ®ï¼ˆè°¨æ…æ“ä½œï¼‰
# rm -rf D:/myprogram/cs_learning/dataset/1/training_data/
```

### 3. æ•°æ®åº“ä¼˜åŒ–

```sql
-- æ·»åŠ ç´¢å¼•åŠ é€ŸæŸ¥è¯¢
CREATE INDEX IF NOT EXISTS idx_player_round
ON training_windows(player_steam_id, round_number);

-- æŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯
SELECT
    player_name,
    round_number,
    COUNT(*) as window_count,
    COUNT(*) * 10 as total_frames
FROM training_windows
GROUP BY player_name, round_number
ORDER BY round_number;
```

---

## å¸¸è§é—®é¢˜ FAQ

### Q1ï¼šSteam å¿…é¡»ä¸€ç›´è¿è¡Œå—ï¼Ÿ

**Aï¼š** æ˜¯çš„ã€‚CS2 æ˜¯ Steam å¹³å°æ¸¸æˆï¼Œå¿…é¡»é€šè¿‡ Steam å¯åŠ¨ã€‚å½•åˆ¶æœŸé—´ï¼š

- âœ… Steam å®¢æˆ·ç«¯å¿…é¡»è¿è¡Œ
- âœ… Steam å¿…é¡»å·²ç™»å½•
- âœ… ä¸è¦åœ¨ Steam ä¸­å¯åŠ¨å…¶ä»–æ¸¸æˆ
- âš ï¸ å¦‚æœ Steam æ„å¤–å…³é—­ï¼Œå½•åˆ¶ä¼šå¤±è´¥

**æ£€æŸ¥ Steam çŠ¶æ€ï¼š**

```bash
tasklist | findstr -i "steam.exe"
```

### Q2ï¼šæˆ‘çš„ CS2 å®‰è£…åœ¨éé»˜è®¤ä½ç½®ï¼Œå¦‚ä½•é…ç½®ï¼Ÿ

**Aï¼š** ä¿®æ”¹ `scripts/cli-generate-frames.mjs` æ–‡ä»¶ä¸­çš„ CS2 è·¯å¾„ï¼ˆçº¦ç¬¬ 194 è¡Œï¼‰ï¼š

```javascript
const cs2Path = 'ä½ çš„CS2è·¯å¾„/game/bin/win64/cs2.exe';
```

### Q2ï¼šæ•°æ®åº“å¯†ç ä¸æ˜¯ 88683139ï¼Œå¦‚ä½•ä¿®æ”¹ï¼Ÿ

**Aï¼š** ä¿®æ”¹æ‰€æœ‰è„šæœ¬ä¸­çš„æ•°æ®åº“é…ç½®ï¼š

- `scripts/cli-generate-frames.mjs`
- `scripts/complete-training-pipeline.mjs`
- `scripts/validate-training-data.mjs`

æœç´¢ `password:` å¹¶ä¿®æ”¹ä¸ºä½ çš„å¯†ç ã€‚

### Q3ï¼šå¦‚ä½•è·å– demo çš„ checksumï¼Ÿ

**Aï¼š** è¿è¡Œä»»æ„ CLI å‘½ä»¤å¤„ç† demo åï¼Œä½¿ç”¨ï¼š

```bash
node out/cli.js query-training --limit 1
```

è¾“å‡ºä¸­ä¼šæ˜¾ç¤º `Demo Checksum: xxx`ã€‚

### Q4ï¼šå½•åˆ¶æ—¶ CS2 çª—å£å¯ä»¥æœ€å°åŒ–å—ï¼Ÿ

**Aï¼š** ä¸å¯ä»¥ã€‚CS2 å¿…é¡»ä¿æŒçª—å£å¯è§æ‰èƒ½æ­£ç¡®å½•åˆ¶å¸§ã€‚å½•åˆ¶æœŸé—´è¯·å‹¿æ“ä½œæ¸¸æˆçª—å£ã€‚

### Q5ï¼šæ¯ä¸ªå›åˆéœ€è¦å¤šé•¿æ—¶é—´å½•åˆ¶ï¼Ÿ

**Aï¼š** å–å†³äºå›åˆé•¿åº¦å’Œçª—å£æ•°é‡ï¼š

- çŸ­å›åˆï¼ˆ20-30ç§’ï¼‰ï¼šçº¦ 2-3 åˆ†é’Ÿ
- é•¿å›åˆï¼ˆ60-90ç§’ï¼‰ï¼šçº¦ 5-8 åˆ†é’Ÿ

ç³»ç»Ÿéœ€è¦å¯åŠ¨ CS2ã€åŠ è½½ demoã€å®šä½åˆ°å›åˆã€å½•åˆ¶å¸§ã€å…³é—­æ¸¸æˆã€‚

### Q6ï¼šå¯ä»¥åŒæ—¶å½•åˆ¶å¤šä¸ªå›åˆå—ï¼Ÿ

**Aï¼š** ä¸å»ºè®®ã€‚æ¯æ¬¡åªèƒ½è¿è¡Œä¸€ä¸ª CS2 å®ä¾‹ã€‚æ‰¹é‡å¤„ç†è¯·ä½¿ç”¨å¾ªç¯è„šæœ¬é¡ºåºæ‰§è¡Œã€‚

### Q7ï¼šç”Ÿæˆçš„å›¾ç‰‡è´¨é‡å¦‚ä½•è°ƒæ•´ï¼Ÿ

**Aï¼š** é»˜è®¤åˆ†è¾¨ç‡ä¸º 1280Ã—720ã€‚ä¿®æ”¹ `cli-generate-frames.mjs` ä¸­çš„å¯åŠ¨å‚æ•°ï¼š

```javascript
-width 1920 -height 1080  // æ”¹ä¸ºä½ æƒ³è¦çš„åˆ†è¾¨ç‡
```

### Q8ï¼šä¸ºä»€ä¹ˆæ•°æ®åº“ä¸­æœ‰è®°å½•ä½†å›¾ç‰‡æ–‡ä»¶ä¸å­˜åœ¨ï¼Ÿ

**Aï¼š** å¯èƒ½åŸå› ï¼š

1. CS2 å½•åˆ¶è¢«ä¸­æ–­ï¼ˆæ£€æŸ¥ CS2 è¿›ç¨‹ï¼‰
2. å›¾ç‰‡ç§»åŠ¨å¤±è´¥ï¼ˆæ£€æŸ¥ç£ç›˜ç©ºé—´å’Œæƒé™ï¼‰
3. è·¯å¾„é…ç½®é”™è¯¯ï¼ˆæ£€æŸ¥è¾“å‡ºç›®å½•é…ç½®ï¼‰

è§£å†³ï¼šé‡æ–°è¿è¡Œ `cli-generate-frames.mjs` è„šæœ¬ã€‚

### Q9ï¼šå¦‚ä½•åˆ é™¤æŸä¸ªç©å®¶/å›åˆçš„è®­ç»ƒæ•°æ®ï¼Ÿ

**Aï¼š**

```bash
# åˆ é™¤æ•°æ®åº“è®°å½•
export PGPASSWORD='88683139'
psql -h 127.0.0.1 -U postgres -d csdm -c \
  "DELETE FROM training_windows WHERE player_steam_id='<Steam_ID>' AND round_number=<å›åˆå·>;"

# åˆ é™¤å›¾ç‰‡æ–‡ä»¶
rm -rf "D:/myprogram/cs_learning/dataset/1/training_data/<ç©å®¶å>_<Steam_ID>_round<å›åˆå·>"
```

### Q10ï¼šXå…‰ï¼ˆspec_show_xrayï¼‰å¦‚ä½•æ§åˆ¶ï¼Ÿ

**Aï¼š** ä¿®æ”¹ `scripts/cli-generate-frames.mjs` ç¬¬ 172 è¡Œï¼š

```javascript
{ tick: 1, cmd: 'spec_show_xray 0' }  // 0=å…³é—­ï¼Œ1=å¼€å¯
```

### Q11ï¼šPython æ•°æ®åŠ è½½å™¨åœ¨å“ªé‡Œï¼Ÿ

**Aï¼š** ä½äº `scripts/cs2_training_loader.py`ã€‚ä½¿ç”¨å‰ç¡®ä¿å®‰è£…ä¾èµ–ï¼š

```bash
pip install psycopg2-binary pillow numpy torch torchvision
```

### Q12ï¼šå¦‚ä½•æŸ¥çœ‹æŸä¸ª demo æœ‰å“ªäº›ç©å®¶ï¼Ÿ

**Aï¼š**

```bash
node out/cli.js training-data "demoè·¯å¾„.dem" --list-players
```

### Q13ï¼šè®­ç»ƒæ•°æ®å¯ä»¥å¯¼å‡ºåˆ°å…¶ä»–æ ¼å¼å—ï¼Ÿ

**Aï¼š** å¯ä»¥ã€‚æ•°æ®åœ¨æ•°æ®åº“ä¸­æ˜¯ç»“æ„åŒ–çš„ï¼Œå¯ä»¥å†™è„šæœ¬å¯¼å‡ºä¸ºï¼š

- JSON æ–‡ä»¶
- CSV æ–‡ä»¶
- TFRecordï¼ˆTensorFlowï¼‰
- LMDBï¼ˆæ·±åº¦å­¦ä¹ å¸¸ç”¨ï¼‰

å‚è€ƒ `scripts/export-training-metadata.mjs` äº†è§£å¯¼å‡ºé€»è¾‘ã€‚

### Q14ï¼šç³»ç»Ÿæ”¯æŒ CSGOï¼ˆCS:GOï¼‰çš„ demo å—ï¼Ÿ

**Aï¼š** ç†è®ºä¸Šæ”¯æŒï¼Œä½†æœ¬ç³»ç»Ÿä¸»è¦é’ˆå¯¹ CS2 ä¼˜åŒ–ã€‚CSGO demo å¯èƒ½éœ€è¦è°ƒæ•´éƒ¨åˆ†å‘½ä»¤å’Œé…ç½®ã€‚

### Q15ï¼šå½•åˆ¶å¤±è´¥åå¦‚ä½•æ¸…ç†æ®‹ç•™è¿›ç¨‹ï¼Ÿ

**Aï¼š**

```bash
# Windows
cmd.exe /c "taskkill /F /IM cs2.exe /T"
cmd.exe /c "taskkill /F /IM node.exe /T"

# æˆ–ä½¿ç”¨ä»»åŠ¡ç®¡ç†å™¨æ‰‹åŠ¨ç»“æŸè¿›ç¨‹
```

---

## æ€»ç»“

ä½ çš„ç³»ç»Ÿå·²ç»å®Œå…¨é…ç½®å¥½äº†ï¼å¯ä»¥ç›´æ¥å¼€å§‹æ”¶é›†è®­ç»ƒæ•°æ®ã€‚

**ä¸‹ä¸€æ­¥æ“ä½œï¼š**

1. å‡†å¤‡ä½ çš„ demo æ–‡ä»¶
2. è·å–è¦åˆ†æçš„ç©å®¶ Steam ID
3. è¿è¡Œå®Œæ•´æµæ°´çº¿ï¼š
   ```bash
   cd D:\myprogram\cs_learning\tools\cs-demo-manager
   node scripts/complete-training-pipeline.mjs "demoè·¯å¾„" Steam_ID å›åˆå·
   ```
4. æŸ¥è¯¢å’ŒéªŒè¯ç”Ÿæˆçš„æ•°æ®
5. ä½¿ç”¨ Python åŠ è½½æ•°æ®è¿›è¡Œæ¨¡å‹è®­ç»ƒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒæ•…éšœæ’æŸ¥ç« èŠ‚æˆ–æŸ¥çœ‹åŸå§‹æ–‡æ¡£ `README_TRAINING_DATA.md`ã€‚

---

## é™„å½•

### A. ç›¸å…³æ–‡æ¡£

æœ¬é¡¹ç›®åŒ…å«å¤šä¸ªè¯¦ç»†æ–‡æ¡£ï¼Œä½äºé¡¹ç›®æ ¹ç›®å½•ï¼š

| æ–‡æ¡£                            | è¯´æ˜                     |
| ------------------------------- | ------------------------ |
| `README_TRAINING_DATA.md`     | è®­ç»ƒæ•°æ®æ”¶é›†ç³»ç»Ÿå®Œæ•´è¯´æ˜ |
| `TRAINING_DATA_PIPELINE.md`   | æ•°æ®æµæ°´çº¿è¯¦ç»†æ–‡æ¡£       |
| `TRAINING_DATA_SYSTEM.md`     | ç³»ç»Ÿæ¶æ„å’Œè®¾è®¡æ–‡æ¡£       |
| `TRAINING_DATA_VALIDATION.md` | æ•°æ®éªŒè¯å·¥å…·è¯´æ˜         |
| `ç¯å¢ƒé…ç½®æ•™ç¨‹.md`             | æœ¬æ–‡æ¡£                   |

### B. æœ‰ç”¨çš„è„šæœ¬

é¡¹ç›®æä¾›äº†å¤šä¸ªè¾…åŠ©è„šæœ¬ï¼ˆä½äº `scripts/` ç›®å½•ï¼‰ï¼š

| è„šæœ¬                               | åŠŸèƒ½               |
| ---------------------------------- | ------------------ |
| `batch-complete-pipeline.mjs` | **æ‰¹é‡å®Œæ•´æµæ°´çº¿ï¼ˆæ¨èï¼‰** |
| `complete-training-pipeline.mjs` | å®Œæ•´æµæ°´çº¿ï¼ˆå•ä¸ªç©å®¶å•å›åˆï¼‰ |
| `smart-batch-pipeline.mjs` | æ™ºèƒ½æ‰¹é‡è®­ç»ƒï¼ˆä¸€æ¬¡å¯åŠ¨å½•å¤šå›åˆï¼‰ |
| `cli-generate-frames.mjs`        | å¸§ç”Ÿæˆè„šæœ¬ï¼ˆå•å›åˆï¼‰         |
| `cli-generate-frames-batch.mjs` | å¸§ç”Ÿæˆè„šæœ¬ï¼ˆå¤šå›åˆï¼‰ |
| `validate-training-data.mjs`     | æ•°æ®éªŒè¯           |
| `query-training-data.mjs`        | æ•°æ®æŸ¥è¯¢           |
| `analyze-training-data.mjs`      | æ•°æ®åˆ†æ           |
| `analyze-storage-space.mjs`      | å­˜å‚¨ç©ºé—´åˆ†æ       |
| `estimate-dataset-size.mjs`      | æ•°æ®é›†å¤§å°ä¼°ç®—     |
| `install-plugin.mjs`             | è‡ªåŠ¨å®‰è£…æ’ä»¶       |
| `cs2_training_loader.py`         | Python æ•°æ®åŠ è½½å™¨  |

### C. å¤–éƒ¨èµ„æº

- **CS Demo Manager å®˜ç½‘ï¼š** https://cs-demo-manager.com/
- **é¡¹ç›® GitHubï¼š** https://github.com/akiver/cs-demo-manager
- **Steam ID æŸ¥è¯¢ï¼š** https://steamid.io/
- **PostgreSQL æ–‡æ¡£ï¼š** https://www.postgresql.org/docs/
- **Node.js æ–‡æ¡£ï¼š** https://nodejs.org/docs/

### D. æ•°æ®é›†è§„æ ¼å‚è€ƒ

| å‚æ•°       | é»˜è®¤å€¼    | å¯é…ç½® |
| ---------- | --------- | ------ |
| æ—¶é—´çª—å£   | 400ms     | âœ…     |
| å¸§ç‡       | 25fps     | âœ…     |
| æ¯çª—å£å¸§æ•° | 10 å¸§     | è®¡ç®—å€¼ |
| å›¾ç‰‡æ ¼å¼   | JPG       | âœ…     |
| åˆ†è¾¨ç‡     | 1280Ã—720 | âœ…     |
| å›¾ç‰‡è´¨é‡   | é»˜è®¤      | âœ…     |
| Xå…‰æ¨¡å¼    | å…³é—­      | âœ…     |

### E. æ€§èƒ½åŸºå‡†

åŸºäºæµ‹è¯•ç¯å¢ƒï¼ˆi7-9700K, 16GB RAM, SSDï¼‰ï¼š

| é¡¹ç›®               | æ•°å€¼      |
| ------------------ | --------- |
| å•ä¸ªçª—å£å¤„ç†æ—¶é—´   | çº¦ 2-3 ç§’ |
| å•å›åˆå¹³å‡çª—å£æ•°   | 50-100 ä¸ª |
| å•å›åˆå¹³å‡å¤„ç†æ—¶é—´ | 3-8 åˆ†é’Ÿ  |
| å›¾ç‰‡æ–‡ä»¶å¹³å‡å¤§å°   | 50-200 KB |
| å•å›åˆç£ç›˜å ç”¨     | 25-200 MB |
| æ•°æ®åº“å•æ¡è®°å½•å¤§å° | çº¦ 2-5 KB |

### F. æŠ€æœ¯æ ˆ

| ç»„ä»¶         | æŠ€æœ¯                         |
| ------------ | ---------------------------- |
| åç«¯         | Node.js, TypeScript          |
| æ•°æ®åº“       | PostgreSQL                   |
| Demo è§£æ    | @akiver/cs-demo-analyzer     |
| æ¸¸æˆäº¤äº’     | CS2 Console Commands         |
| å›¾ç‰‡å¤„ç†     | CS2 å†…ç½® `startmovie` å‘½ä»¤ |
| Python åŠ è½½  | psycopg2, Pillow, NumPy      |
| æ·±åº¦å­¦ä¹ æ¡†æ¶ | PyTorch, TensorFlowï¼ˆå¯é€‰ï¼‰  |

### G. è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº [MIT License](https://github.com/akiver/cs-demo-manager/blob/main/LICENSE)ã€‚

### H. è´¡çŒ®ä¸åé¦ˆ

å¦‚æœå‘ç°é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼š

1. æŸ¥çœ‹ [GitHub Issues](https://github.com/akiver/cs-demo-manager/issues)
2. æäº¤æ–°çš„ Issue æˆ– Pull Request
3. å‚è€ƒ [Contributing Guide](https://cs-demo-manager.com/docs/contributing)

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** 1.1
**æœ€åæ›´æ–°ï¼š** 2026-01-11
**é€‚ç”¨ç³»ç»Ÿç‰ˆæœ¬ï¼š** cs-demo-manager v3.17.0
**æ›´æ–°å†…å®¹ï¼š**
- æ·»åŠ æ•°æ®åº“åˆå§‹åŒ–æ­¥éª¤ï¼ˆæ­¥éª¤3ï¼‰
- æ·»åŠ  batch-complete-pipeline.mjs ä½¿ç”¨è¯´æ˜
- æ›´æ–°å€é€Ÿé…ç½®ä¸º1xï¼ˆç¨³å®šæ€§ä¼˜å…ˆï¼‰
- è¡¥å……å€é€Ÿæµ‹è¯•å†å²æ•°æ®
